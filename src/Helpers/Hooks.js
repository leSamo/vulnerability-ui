import { useEffect } from 'react';
import { useDispatch } from 'react-redux';
import {
    addNotification as addNotificationFEC,
    clearNotifications as clearNotificationsFEC
} from '@redhat-cloud-services/frontend-components-notifications/redux';

export const useNotification = (config) => {
    const dispatch = useDispatch();

    const globalConfig = {
        variant: 'info',
        ...config
    };

    useEffect(() => {
        return () => {
            if (!config.preventClear) {
                dispatch(clearNotificationsFEC());
            }
        };
    }, [dispatch]);

    const addNotification = ({ msg, ...config }) =>
        dispatch(
            addNotificationFEC({
                title: msg,
                ...globalConfig,
                ...config
            })
        );

    return addNotification;
};

export const useClearNotifications = () => {
    const dispatch = useDispatch();

    const clearNotifs = () =>
        dispatch(clearNotificationsFEC());

    return clearNotifs;
};
